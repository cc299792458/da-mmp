<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>DA-MMP</title>
  <link rel="icon" type="image/png" href="imgs/logo-icon.png" />

  <!-- SEO -->
  <meta name="description" content="DA-MMP is a dynamics-aware motion manifold framework for robotic throwing, generating coordinated and accurate trajectories in real-world ring-tossing tasks." />

  <!-- Open Graph -->
  <meta property="og:title" content="DA-MMP: Dynamics-Aware Motion Manifold Primitives" />
  <meta property="og:description" content="DA-MMP generates dynamics-aware throwing trajectories from motion manifolds, achieving human-level performance in robotic ring-tossing." />
  <meta property="og:image" content="https://yourdomain.com/imgs/teaser.png" />
  <meta property="og:url" content="https://yourdomain.com/" />
  <meta property="og:type" content="website" />

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="DA-MMP: Dynamics-Aware Motion Manifold Primitives" />
  <meta name="twitter:description" content="DA-MMP generates dynamics-aware throwing trajectories from motion manifolds, achieving human-level performance in robotic ring-tossing." />
  <meta name="twitter:image" content="https://yourdomain.com/imgs/teaser.png" />

  <!-- Google Fonts: Inter -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet" />

  <!-- Site styles -->
  <link rel="stylesheet" href="style.css" />

  <!-- MathJax -->
  <script>
    window.MathJax = { tex: { inlineMath: [['\\(', '\\)']] }, svg: { fontCache: 'global' } };
  </script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
</head>

<body>
  <!-- Title -->
  <h1>
    DA-MMP: Learning Coordinated and Accurate Throwing with<br>
    Dynamics-Aware Motion Manifold Primitives
  </h1>

  <!-- Authors -->
  <div class="authors">
    <a class="author" href="https://cc299792458.github.io/" target="_blank" rel="noopener noreferrer">Chi Chu<sup>1</sup></a>
    <span class="sep">·</span>
    <a class="author" href="http://hxu.rocks/" target="_blank" rel="noopener noreferrer">Huazhe Xu<sup>2,1</sup></a>
  </div>

  <!-- Affiliations -->
  <div class="affiliations">
    <sup>1</sup> Shanghai Qi Zhi Institute,
    <sup>2</sup> Institute for Interdisciplinary Information Sciences, Tsinghua University,
  </div>

  <!-- Links -->
  <div class="links" aria-label="Project links">
    <!-- Unified button structure: icon + label -->
    <a class="btn" href="paper.pdf" target="_blank" rel="noopener noreferrer">
      <img class="icon" src="imgs/icons/pdf.svg" alt="PDF" />
      <span>Paper (coming soon)</span>
    </a>
    <a class="btn" href="https://arxiv.org/abs/xxxx" target="_blank" rel="noopener noreferrer">
      <img class="icon" src="imgs/icons/arxiv.svg" alt="arXiv" />
      <span>arXiv (coming soon)</span>
    </a>
    <a class="btn" href="https://x.com/your_handle" target="_blank" rel="noopener noreferrer">
      <img class="icon" src="imgs/icons/twitter-x.svg" alt="Summary" />
      <span>Summary (coming soon)</span>
    </a>
    <a class="btn" href="https://github.com/cc299792458/da-mmp" target="_blank" rel="noopener noreferrer">
      <img class="icon" src="imgs/icons/github.svg" alt="GitHub" />
      <span>Code (coming soon)</span>
    </a>
  </div>

  <!-- Video -->
  <section class="section" aria-label="Video">
    <div class="video-container">
      <iframe
        src="https://www.youtube-nocookie.com/embed/93DnXD1sHvk"
        title="DA-MMP — Project Video"
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
        allowfullscreen>
      </iframe>
    </div>
  </section>

  <!-- Abstract -->
  <section class="section" aria-labelledby="abstract-title">
    <h2 id="abstract-title">Abstract</h2>
    <p>
      Dynamic manipulation is a key capability for advancing robot performance, enabling skills such as tossing. 
      While recent learning-based approaches have pushed the field forward, most methods still rely on manually designed action parameterizations, limiting their ability to produce the highly coordinated motions required in complex tasks. 
      Motion planning can generate feasible trajectories, but the dynamics gap—stemming from control inaccuracies, contact uncertainties, and aerodynamic effects—often causes large deviations between planned and executed trajectories. 
      In this work, we propose Dynamics-Aware Motion Manifold Primitives (DA-MMP), a motion generation framework for goal-conditioned dynamic manipulation, and instantiate it on a challenging real-world ring-tossing task.
      Our approach extends motion manifold primitives to variable-length trajectories through a compact parametrization and learns a high-quality manifold from a large-scale dataset of planned motions. 
      Building on this manifold, a conditional flow matching model is trained in the latent space with a small set of real-world trials, enabling the generation of throwing trajectories that account for execution dynamics.
      Experiments show that our method can generate coordinated and smooth motion trajectories for the ring-tossing task.
      In real-world evaluations, it achieves high success rates and even surpasses the performance of trained human experts.
      Moreover, it generalizes to novel targets beyond the training range, indicating that it successfully learns the underlying trajectory–dynamics mapping.
    </p>
  </section>

  <!-- Method -->
  <section class="section" id="method" aria-labelledby="method-title">
    <h2 id="method-title">Method</h2>

    <!-- Method figure -->
    <figure class="figure">
      <img
        src="imgs/method_pipeline.png"
        alt="DA-MMP method pipeline overview"
        loading="lazy"
        decoding="async"
        width="1600" height="900"
        sizes="(max-width: 1000px) 100vw, 1000px"
        class="figure-img" />
      <figcaption class="caption">
        <strong>Overview of DA-MMP.</strong>
        Stage I (blue): data collection from goal-manifold sampling, motion planning, and parameterization, yielding 90k planned trajectories.
        Stage II (red/green): policy learning with an autoencoder to learn motion manifolds and a conditional flow-matching model for trajectory–dynamics mapping.
      </figcaption>
    </figure>

    <!-- Method body -->
    <div class="method-body">
      <!-- Problem -->
      <h3 class="subheading">Problem</h3>
      <p class="method-text">
        In this project, we address a real-world robotic ring-tossing task. 
        The task is challenging due to the need for <strong>highly coordinated, high-speed motions</strong> and <strong>dynamics gaps stemming from control, contact, and aerodynamics</strong>. 
        The goal is to produce a joint trajectory \( \tau \) that releases a grasped ring to land around a distant peg accurately.
      </p>

      <!-- Key Idea -->
      <h3 class="subheading">Key Idea</h3>
      <p class="method-text">
        DA-MMP generates dynamics-aware throwing trajectories in two stages: 
        (I) build a <strong>low-dimensional motion manifold</strong> from a large set of planned trajectories, and 
        (II) align this manifold to <strong>real execution dynamics</strong> using a conditional flow-matching policy trained with few real trials.
      </p>

      <!-- Stage I -->
      <h3 class="phase-heading">Stage I. Data Collection</h3>
      <div class="method-grid">
        <div class="card">
          <h4>Goal-Manifold Sampling</h4>
          <p>
            We adopt goal-manifold sampling to generate candidate throwing states.
            By leveraging projectile equations and task geometry, each candidate specifies a feasible end-effector pose and velocity at release.
            Infeasible candidates are rejected, yielding a goal manifold.
          </p>
        </div>
        <div class="card">
          <h4>Sampling-Based Motion Planning</h4>
          <p>
            Given a feasible throwing state, we use a kinodynamic planner (DIMT-RRT) to generate motion trajectories.
            Each plan is refined with shortcut smoothing and validated through collision checks and stability tests,
            resulting in a large-scale dataset of feasible throwing trajectories.
          </p>
        </div>
      </div>

      <!-- Stage II -->
      <h3 class="phase-heading">Stage II. Policy Learning</h3>
      <div class="method-grid">
        <div class="card">
          <h4>Variable-Length Trajectory Parameterization</h4>
          <p>
            To parameterize variable-length motion trajectories without distorting the release velocity,
            we explicitly include trajectory length in the parameterization.
            Inspired by via-point movement primitives, we use gated radial basis functions combined with a cubic Hermite spline that enforces start and end conditions
            to parameterize trajectories in a smooth and consistent manner.
            Each trajectory is parameterized by its length, boundary conditions, and basis weights.
          </p>
        </div>
        <div class="card">
          <h4>Learning Motion Manifold Primitives</h4>
          <p>
            We train an autoencoder on the full parameterized trajectories dataset to learn a high-quality, low-dimensional motion manifold.
            On top of this latent space, a conditional flow-matching model is trained on few real-world trials to align planned trajectories with real execution dynamics,
            using observed landing outcomes as conditioning signals.
            This design enables dynamics-aware trajectory generation with strong data efficiency.
          </p>
        </div>
      </div>
    </div>
  </section>

  <!-- Experiments -->
  <section class="section" aria-labelledby="experiments-title">
    <h2 id="experiments-title">Experiments</h2>

    <!-- Main quantitative results -->
    <div class="exp-body">
      <h3 class="subheading">Main Results: Dynamics-Aware Trajectory Generation</h3>
      <p>
        We compare DA-MMP against planning-based baselines and human performance in simulation and real world. 
        Success rate (SR) is defined as the fraction of trials in which the ring lands around the peg; 
        results are averaged over three random seeds with 10 random targets each. 
        <strong>Residual-style correction</strong> achieves very high success in simulation but <strong>fails in the real world</strong> due to uncontrolled variance. 
        In contrast, <strong>DA-MMP</strong> attains the highest real-world success rate, even <strong>slightly outperforming trained human experts</strong>.
      </p>

      <table class="exp-table">
        <thead>
          <tr>
            <th>Method</th>
            <th>Simulation SR (%)</th>
            <th>Real SR (%)</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Motion planning (1 attempt)</td>
            <td>0.0</td>
            <td>13.3</td>
          </tr>
          <tr>
            <td>Motion planning (2 attempts)</td>
            <td>0.0</td>
            <td>23.3</td>
          </tr>
          <tr>
            <td>Residual-style correction</td>
            <td><strong>93.3</strong></td>
            <td>6.7</td>
          </tr>
          <tr>
            <td><strong>DA-MMP (Ours)</strong></td>
            <td>53.3</td>
            <td><strong>60.0</strong></td>
          </tr>
          <tr>
            <td>Human novice</td>
            <td>--</td>
            <td>13.3</td>
          </tr>
          <tr>
            <td>Human expert</td>
            <td>--</td>
            <td>56.7</td>
          </tr>
        </tbody>
      </table>
      <div class="caption center">
        Success rate (SR) comparison in simulation and the real world.
      </div>
    </div>

    <!-- Our Method -->
    <div class="exp-body">
      <h3 class="subheading">DA-MMP (Ours)</h3>
      <p>
        We evaluate DA-MMP across multiple target distances. The method consistently generates coordinated trajectories and achieves accurate landings. 
        It can also <strong>generalize to targets beyond the training range</strong>. In the unseen case, the policy exhibits <strong>slower throwing motions</strong>, 
        suggesting that it has indeed captured the underlying <strong>trajectory–dynamics mapping</strong> rather than memorizing target-specific controls.
      </p>

      <!-- Three videos in one row -->
      <div class="exp-video-row">
        <figure class="vid">
          <video controls preload="metadata" playsinline>
            <source src="videos/dammp_1_8m.mp4" type="video/mp4" />
          </video>
          <figcaption class="caption center">\( r = 1.8\,\mathrm{m} \)</figcaption>
        </figure>

        <figure class="vid">
          <video controls preload="metadata" playsinline>
            <source src="videos/dammp_1_6m.mp4" type="video/mp4" />
          </video>
          <figcaption class="caption center">\( r = 1.6\,\mathrm{m} \)</figcaption>
        </figure>

        <figure class="vid">
          <video controls preload="metadata" playsinline>
            <source src="videos/dammp_1_2m.mp4" type="video/mp4" />
          </video>
          <figcaption class="caption center">
            \( r = 1.2\,\mathrm{m} \) <span style="color:#dc2626;">(unseen)</span>
          </figcaption>
        </figure>
      </div>
      
      <h3 class="subheading">Baseline: Motion Planning</h3>
      <p>
        Here we show <strong>3 trials for \( r = 1.8\,\mathrm{m} \)</strong> using motion planning. 
        Note that for the same target, <strong>different planned trajectories result in very different landing positions</strong>. 
        This inconsistency across planned trajectories not only leads to a <strong>low success rate</strong>,  
        but also <strong>prevents residual-correction methods from working</strong>.
      </p>

      <!-- Three baseline videos in one row -->
      <div class="exp-video-row">
        <figure class="vid">
          <video controls preload="metadata" playsinline>
            <source src="videos/baseline_trial1.mp4" type="video/mp4" />
          </video>
          <figcaption class="caption center">Trial&nbsp;1 (\( r = 1.8\,\mathrm{m} \))</figcaption>
        </figure>

        <figure class="vid">
          <video controls preload="metadata" playsinline>
            <source src="videos/baseline_trial2.mp4" type="video/mp4" />
          </video>
          <figcaption class="caption center">Trial&nbsp;2 (\( r = 1.8\,\mathrm{m} \))</figcaption>
        </figure>

        <figure class="vid">
          <video controls preload="metadata" playsinline>
            <source src="videos/baseline_trial3.mp4" type="video/mp4" />
          </video>
          <figcaption class="caption center">Trial&nbsp;3 (\( r = 1.8\,\mathrm{m} \))</figcaption>
        </figure>
      </div>
    </div>

    <!-- Landing distribution analysis -->
    <h3 class="subheading">Motion Planning Landing Distribution</h3>
    <p>
      To further understand these results, we visualize the <strong>landing distributions under motion planning</strong> 
      in both simulation and the real world, targeting \( r = 1.8\,\mathrm{m} \).
      In simulation, the landings show a <strong>consistent bias with small variance</strong>, mainly due to air drag with minimal control or contact errors.
      In contrast, the real-world landings exhibit both <strong>bias and variance</strong>, arising from control inaccuracy, contact uncertainty, and perception noise.
      This explains why residual-style correction is highly effective in simulation—where a single bias can be compensated—but fails in reality,
      where variance cannot be corrected by simple replanning.
      Our method, by <strong>encoding trajectories rather than only target positions</strong>, remains effective under such real-world variability.
    </p>

    <div class="exp-figure-row">
      <div class="exp-fig">
        <img src="imgs/landing_scatter_sim_vs_real.png"
             alt="Motion planning landing distributions of throws in simulation and the real world at r=1.8m"
             loading="lazy" decoding="async">
        <figcaption class="caption center">
          Motion planning landing distributions in simulation vs. real world at \( r = 1.8\,\mathrm{m} \).
        </figcaption>
      </div>
    </div>

    <!-- Ablations -->
    <div class="exp-body">
      <h3 class="subheading">Ablations</h3>

      <!-- Effect of Autoencoder -->
      <div class="ablation">
        <div class="ablation-text">
          <h4>Effect of the Autoencoder</h4>
          <p>
            To evaluate the role of the autoencoder, we compare DA-MMP against a variant
            trained directly on raw trajectory parameterizations. The no-AE variant yields
            irregular joint profiles rarely executable, while DA-MMP produces smooth and
            coherent motions.
          </p>
        </div>
        <div class="ablation-fig">
          <img src="imgs/ae_ablation.png"
               alt="Effect of the autoencoder on trajectory generation"
               loading="lazy" decoding="async">
          <figcaption class="caption">
            Effect of the autoencoder on trajectory generation.
          </figcaption>
        </div>
      </div>

      <!-- Effect of Dataset Scale -->
      <div class="ablation">
        <div class="ablation-text">
          <h4>Effect of Dataset Scale</h4>
          <p>
            We study the effect of dataset size by training the autoencoder with 0.9k, 9k,
            and 90k planned trajectories. Larger datasets consistently reduce reconstruction
            error, confirming the need for large-scale planning data to capture diverse
            feasible motions.
          </p>
        </div>
        <div class="ablation-fig">
          <table class="exp-table">
            <thead>
              <tr>
                <th>Dataset size</th>
                <th>Parameter-Space RMSE</th>
                <th>LRE (%)</th>
              </tr>
            </thead>
            <tbody>
              <tr><td>0.9k</td><td>0.700</td><td>22.6</td></tr>
              <tr><td>9k</td><td>0.005</td><td>1.3</td></tr>
              <tr><td>90k</td><td><strong>0.001</strong></td><td><strong>0.7</strong></td></tr>
            </tbody>
          </table>
          <figcaption class="caption">
            Effect of dataset scale on autoencoder reconstruction.
          </figcaption>
        </div>
      </div>
    </div>
  </section>

  <!-- Citations -->
  <section class="section-left" aria-labelledby="citations-title">
    <h2 id="citations-title">Citations</h2>
    <pre><code>@article{chu2025dammp,
  title   = {DA-MMP: Learning Coordinated and Accurate Throwing with Dynamics-Aware Motion Manifold Primitives},
  author  = {Chi Chu and Huazhe Xu},
  journal = {arXiv preprint arXiv:coming soon},
  year    = {2025}
}</code></pre>
  </section>
</body>
</html>
